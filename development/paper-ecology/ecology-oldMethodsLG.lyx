#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Section
Method
\end_layout

\begin_layout Plain Layout
The MultiGWAS tool has three main steps: the adjustment state, the multi
 analysis stage, and the integration step (Fig.
 1).
 In the first stage, we process the configuration file.
 Then the genotype and phenotype are cleaned and filtered and we "diploidize"
 the genomic data.
 In the second stage, each GWAS tool runs in parallel.
 In the last stage, after the output files scanning, a summary of results
 is generated in a report that contains score tables, Venn diagrams, SNP
 profiles, and Manhattan plots.
\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename images/multiGWAS-flowchart-stages.pdf
	width 12cm

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
MultiGWAS flowchart has three stages: adjustment, multi analysis, and integratio
n.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Adjustment stage
\end_layout

\begin_layout Plain Layout
MultiGWAS takes as input a configuration file where the user specifies the
 genomics data along with the parameters that will be used by the four tools.
 The configuration file includes the following parameters:
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

%genotype/phenotype filenames, genome-wide significance threshold, multiple
 testing correction methods, GWAS model, number of associations to be reported,
 and TRUE or FALSE whether to use quality control (QC) filters or not.
 
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Input genotype and phenotype file formats
\end_layout

\begin_layout Plain Layout
Currently, MultiGWAS uses two input files, one for genotype and the other
 for phenotype, both files correspond to data matrices with column and row
 names (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:File-Formats"

\end_inset

).
 The genotype file uses a markes vs.
 individuals format (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:File-Formats"

\end_inset

.a), with the first three columns corresponding to the marker name, chromosome
 number, and position in the chromosome; and the next columns contain the
 marker data for each individual in the population coded in the ”ACGT” format
 (e.g.
 AATT, CCGG, AAAT, GGCG).
 And the phenotype file uses and individual vs.
 trait format (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:File-Formats"

\end_inset

.b), with the first column corresponding to the individual name and the second
 to trait value.
\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "60col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "99col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
scriptsize
\end_layout

\end_inset


\family typewriter
Marker,Chrom,Pos,Indiv01,Indiv02,Indiv03,...
\end_layout

\begin_layout Plain Layout

\family typewriter
c2_41437,0,805179,AAAG,AAGG,AAGG,...
\end_layout

\begin_layout Plain Layout

\family typewriter
c2_24258,0,1252430,AAGG,AGGG,GGGG,...
\end_layout

\begin_layout Plain Layout

\family typewriter
c2_21332,0,3499519,TTCC,TTCC,TTCC,...
 
\end_layout

\begin_layout Plain Layout

\family typewriter
...
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

(a)
\end_layout

\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "30col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "99col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
scriptsize
\end_layout

\end_inset


\family typewriter
Individual,Traitname
\end_layout

\begin_layout Plain Layout

\family typewriter
Indiv01, 3.59
\end_layout

\begin_layout Plain Layout

\family typewriter
Indiv02, 4.07
\end_layout

\begin_layout Plain Layout

\family typewriter
Indiv03, 1.05
\end_layout

\begin_layout Plain Layout

\family typewriter
...
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

(b)
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Note Note
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/tmp-tables-file-formats.png

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
scriptsize
\end_layout

\end_inset

 
\series bold
MultiGWAS genotype and phenotype formats
\series default
.
 Both files are in CSV format (Comma Separated Values), and contain as first
 row the header labels of the columns.
 Although the header labels are arbitry, the column position is obligatory.
 
\series bold
(a)
\series default
 Genotype file format, where 
\begin_inset Quotes eld
\end_inset

Marker
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

Chrom
\begin_inset Quotes erd
\end_inset

, and 
\begin_inset Quotes eld
\end_inset

Pos
\begin_inset Quotes erd
\end_inset

, correspond to the names for marker name, chromosome, and position, respectivel
y, and the next columns correspond to the columns for the individuals 
\series bold
(b)
\series default
 Phenotype file format, where 
\begin_inset Quotes eld
\end_inset

Individual
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

Traitname
\begin_inset Quotes erd
\end_inset

 are the column names for the individual and trait names, respectivelly.
\begin_inset CommandInset label
LatexCommand label
name "fig:File-Formats"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Note Note
status collapsed

\begin_layout Itemize

\size footnotesize
In the first stage, inputs are read from a configuration file (see below)
 and the genotype and phenotype are cleaned and filtered using the quality
 control (QC) filters.
 
\end_layout

\begin_layout Itemize

\size footnotesize
However, each tool has its own way of doing things: different user interfaces
 (GUI or command line based), different input formats (phenotype and genotype
 formats)
\end_layout

\begin_layout Itemize

\size footnotesize
Then, the filtered genotype and phenotype are transformed to the specific
 formats required for each tool.
 
\end_layout

\begin_layout Itemize

\size footnotesize
The used format of the phenotype and genotype are the same as the the GWASpoly
 software (Rosyara et al., 2016), except that the phenotype file must include
 only one trait without covariates.
 For the genotype file, the first three column correspond to the marker
 name, chromosome number, and position in the chromosome; while the next
 columns contain the marker data for each individual in the population codified
 in the ”ACGT” format (e.g.
 AATT, CCGG, AAAT, GGCG).
 For the phenotype file, the first column contains the individual name,
 and the second contains the trait value.
 
\end_layout

\begin_layout Itemize

\size footnotesize
Chen2018:
\begin_inset Note Note
status open

\begin_layout Plain Layout
Input file formats are automatically converted to the formats corresponding
 to the specified CLI packages.
 iPat uses the first three lines of each input file to determine the formats.
 Acceptable geno-type formats include hapmap, numerical, VCF, PLINK and
 BLINK.
 Phenotype formats are acceptable with or without individual identi-fication.
 When input data formats match the chosen CLI package format requirements,
 analyses are conducted directly.
 Otherwise, format conversion is performed first.
\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\size footnotesize
GWASpoly2016:
\begin_inset Note Note
status open

\begin_layout Plain Layout
The first column of the phenotype file contains the genotype identifier,
 columns 2 through (n.traits + 1) contain trait values, and subsequent columns
 contain the levels (for factors) or numeric values (for covariates) of
 any fixed effects.
 The first three columns of the genotype file are (1) marker name, (2) chromosom
e, and (3) position.
 Subsequent columns contain the marker data for each individual in the populatio
n.
 Marker data can be coded in one of three formats: • "numeric" = markers
 are coded based on the dosage of the alternate allele, taking on integer
 values between 0 and ploidy (fractional values not allowed) • "AB" format
 (e.g., AAAB, ABBB for tetraploids) • "ACGT" format (e.g., AAAT, GGCC for tetraploid
s) Only bi-allelic markers are allowed.
 Missing marker data will be imputed with the population mode (most frequent
 value) for each marker.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
GWAS models
\end_layout

\begin_layout Plain Layout
MultiGWAS is designed to work with quantitative phenotypes and can run GWAS
 analysis using two types of statistical models that we have called 
\emph on
full
\emph default
 and 
\emph on
naive
\emph default
 models.
 The 
\emph on
full model
\emph default
 is know in the literature as the Q+K model 
\begin_inset CommandInset citation
LatexCommand cite
key "Yu2006"

\end_inset

 and includes control for structure (Q) and relatedness between samples
 (K), whereas the 
\emph on
naive model
\emph default
 does not include any type of correction.
 Both models are based on linear regression approaches and variations of
 them are implemented by the four GWAS packages used by MultiGWAS.
 The 
\emph on
naive
\emph default
 is modeled with Generalised Linear Models (GLMs, Phenotype + Genotype),
 and the 
\emph on
full
\emph default
 is modeled with Mixed Linear Models (MLMs, Phenotype + Genotype + Structure
 + Kinship).
 The default model used by MultiGWAS is the 
\emph on
full model
\emph default
 (Q+K) 
\begin_inset CommandInset citation
LatexCommand cite
key "Yu2006"

\end_inset

, which is expressed with the following equation:
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
y=X\beta+S\alpha+Q\nu+Z\mu+e
\]

\end_inset


\end_layout

\begin_layout Plain Layout
where 
\begin_inset Formula $y$
\end_inset

 is the vector of observed phenotypes; 
\begin_inset Formula $\beta$
\end_inset

 is a vector of fixed effects other than SNP or population group effects;
 
\begin_inset Formula $\alpha$
\end_inset

 is a vector of SNP effects (Quantitative Trait Nucleotides); 
\begin_inset Formula $\nu$
\end_inset

 is a vector of population effects; 
\begin_inset Formula $\mu$
\end_inset

 is a vector of polygene background effects; 
\begin_inset Formula $e$
\end_inset

 is a vector of residual effects; 
\begin_inset Formula $Q$
\end_inset

, modeled as a fixed effect, refers to the incidence matrix for subpopulation
 covariates relating 
\begin_inset Formula $y$
\end_inset

 to 
\begin_inset Formula $\nu$
\end_inset

; and 
\begin_inset Formula $X$
\end_inset

, 
\begin_inset Formula $S$
\end_inset

 and 
\begin_inset Formula $Z$
\end_inset

 are incidence matrices of 1s and 0s relating 
\begin_inset Formula $y$
\end_inset

 to 
\begin_inset Formula $\beta$
\end_inset

, 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

, respectively.
\end_layout

\begin_layout Plain Layout
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
The MLM can be described as:
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
Y=u+\text{{SNP}}+\text{{Q\,(or\,\,PCs)}}+\text{{Kinship}}+e
\]

\end_inset


\end_layout

\begin_layout Plain Layout
where, 
\end_layout

\begin_layout Plain Layout
\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Formula $u$
\end_inset

: is the population mean, 
\end_layout

\begin_layout Plain Layout
\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Formula $\text{{SNP}}+\text{{Q\,(or\,\,PCs)}}:$
\end_inset

 represent the fixed effects,
\end_layout

\begin_layout Plain Layout
\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Formula $\text{{Kinship:}}$
\end_inset

 represent the random effects, and
\end_layout

\begin_layout Plain Layout
\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset space ~
\end_inset


\begin_inset Formula $e$
\end_inset

: represent residual effects.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
MultiGWAS runs in parallel using two types of statistical models specified
 in the parameters file, the Full model (Q+K) and Naive (i.e., without any
 control) 
\begin_inset CommandInset citation
LatexCommand cite
key "Sharma2018"

\end_inset

.
 The Full model (Q+K) controls for both population structure and individual
 relatedness.
 For population structure, MultiGWAS uses the Principal Component Analysis
 (PCA) and takes the top ten PC as covariates.
 For relatedness, the tool uses kinship matrices that TASSEL and GWASpoly
 calculated separately, and for PLINK and SHEsis depends on the King software
 
\begin_inset CommandInset citation
LatexCommand cite
key "Manichaikul2010"

\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

%
\backslash
subsubsection{Tools}
\end_layout

\end_inset

We have selected four GWAS software tools to be integrated in our multiGWAS
 tool, two designed specifically for polyploid species as many important
 crops are polyploids: GWASpoly 
\begin_inset CommandInset citation
LatexCommand cite
key "Rosyara2016"

\end_inset

 and SHEsis 
\begin_inset CommandInset citation
LatexCommand cite
key "Yong2006"

\end_inset

, and another two designed for diploids species and extensively used in
 humans and plants: PLINK 
\begin_inset CommandInset citation
LatexCommand cite
key "Purcell2007,Chang2015"

\end_inset

 and TASSEL 
\begin_inset CommandInset citation
LatexCommand cite
key "Bradbury2007"

\end_inset

, respectively.
\end_layout

\begin_layout Plain Layout
As MultiGWAS implements two types of GWAS analysis, naive and full, each
 tool is called in two different ways.
 
\begin_inset ERT
status open

\begin_layout Plain Layout

%The naive without any addi
\end_layout

\begin_layout Plain Layout

tional parameter, but the full with two parameters that take into account
 for population structure (Q) and relatedness (K) to prevent false associations.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Genome-wide significance and multiple testing correction
\end_layout

\begin_layout Plain Layout
GWAS searches SNPs associated with the phenotype in a statistically significant
 manner.
 A threshold or significance level 
\begin_inset Formula $\alpha$
\end_inset

 is specified and compared with the 
\emph on
p-value
\emph default
 derived for each association score.
 Standard significance levels are 0.01 or 0.05 
\begin_inset CommandInset citation
LatexCommand cite
key "Gumpinger2018,Rosyara2016"

\end_inset

.
 However, due to the massive number of statistical tests performed by GWAS,
 it is necessary to perform a correction method for multiple hypothesis
 testing and adjusting the 
\emph on
p-value
\emph default
 threshold accordingly.
 
\end_layout

\begin_layout Plain Layout
Two common methods for multiple hypothesis testing are the false discovery
 rate (FDR) and the Bonferroni correction.
 The latter is the default method used by MultiGWAS, which is the one of
 the most stringent methods.
 However, instead of adjusting the 
\emph on
p-values,
\emph default
 MultiGWAS adjust the threshold below which a 
\emph on
p-value
\emph default
 is considered significant, that is 
\begin_inset Formula $\alpha/m$
\end_inset

, where 
\begin_inset Formula $\alpha$
\end_inset

 is the significance level and 
\emph on
m 
\emph default
is the number of tested markers from the genotype matrix.
 MultiGWAS uses a default 
\begin_inset Formula $\alpha$
\end_inset

 of 0.05.
 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

%Paula: Luis estos parÃ¡metro por default de QC y alpha faltan
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Note Note
status open

\begin_layout Plain Layout
GWAS searches for SNPs that are associated with the phenotype in a statistically
 significant manner, for which a threshold or significance level 
\begin_inset Formula $\alpha$
\end_inset

 is specified and compared with the 
\emph on
p-value
\emph default
 derived for each association score.
 However due to the massive number of statistical tests performed by GWAS,
 the 
\emph on
p-values 
\emph default
must be adjusted appropriately performing a correction method for multiple
 hypothesis testing (MHT).
 
\end_layout

\begin_layout Plain Layout
Two of the most commonly methods used for crops for adjusting 
\emph on
p-values
\emph default
 are the Bonferroni correction and false discovery rate (FDR) 
\begin_inset CommandInset citation
LatexCommand cite
key "Kaler2019"

\end_inset

.
 Both methods are implemented by MultiGWAS, using as defult the Bonferroni
 correction, which is more stringent than FDR, and using a significance
 level of 0.05, which is commonly used in many GWAS studies 
\begin_inset CommandInset citation
LatexCommand cite
key "Gumpinger2018"

\end_inset

, including studies in plants 
\begin_inset CommandInset citation
LatexCommand cite
key "Rosyara2016"

\end_inset

.
 But, MultiGWAS calculates the Bonferroni correction using the number of
 non-missing genotypes (NMISS) included in the analysis instead of the whole
 genotypes.
 Only SHEsis, PLINK, and TASSEL give the NMISS number in their reports.
 In contrast, GWASpoly takes into account of it internally to caclculate
 the corrections.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
.
 In the Bonferroni correction, the threshold is calculated as 
\begin_inset Formula $\alpha/m$
\end_inset

, where 
\emph on
m 
\emph default
is the number of markers from the genotype matrix.
 
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Quality control filters
\end_layout

\begin_layout Plain Layout
Before to start a GWAS analysis is critical to run a preprocessing step
 on the input data to check for genotype or phenotype errors that can lead
 to spurious GWAS results.
 MultiGWAS provides the filtering option to preprocess the input data by
 applying four quality control filters: MAF, MIND, GENO, and, HWE.
 
\end_layout

\begin_layout Plain Layout
MAF of {x} filters out SNPs with minor allele frequency below {x} (default
 0.01); MIND of {x} filters out all individuals with missing genotypes exceeding
 {x}*100% (default 0.1); GENO {x} filters out SNPs with missing values exceeding
 {x}*100% (default 0.1); and HWE filters out SNPs which have Hardy-Weinberg
 equilibrium exact test 
\emph on
p-value
\emph default
 below the {x} threshold.
\end_layout

\begin_layout Plain Layout
MAF filter is implemented by MultiGWAS, but the other three filters: MIND,
 GENO, and HWE are applied using the options provide by PLINK package 
\begin_inset CommandInset citation
LatexCommand cite
key "Gumpinger2018"

\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset Note Comment
status collapsed

\begin_layout Itemize
Before we can start testing for associations between SNPs and the phenotype
 of interest, certain preprocessing tasks are commonly applied to minimize
 the chances of reporting false results.
 
\end_layout

\begin_layout Itemize
Quality control, or QC, is a critical element in doing GWAS.
 Since hundreds of thousands of genotypes are generated, even a small percentage
 of genotyping error can, if unidentified, lead to spurious GWAS results.
 QC can be considered to have two aspects - QC related to genotyping chips
 (i.e.
 issues related to making genotype calls from intensity measurements) and
 downstream QC issues.
 In this exercise, we focus exclusively on downstream QC approaches, i.e.
 data cleaning procedures that can be applied once you already have genotype
 calls.
 Downstream QC covers two major areas of quality - subject-based quality
 measures and variant-based quality measures.
 The specific QC measures for the two domains are: Subject-Based
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Number of reported associations
\end_layout

\begin_layout Plain Layout
Criticism has arisen in considering only statistically significant associations
 as the only possible true associations 
\begin_inset CommandInset citation
LatexCommand cite
key "Thomson2011,Kaler2019"

\end_inset

.
 Many of low 
\emph on
p-value
\emph default
 associations closer to being significants may be important associations
 that are overlooked due to the stringent significance levels, and consequently
 increasing the number of false negatives.
 To help to analyze both significant and non-significant associations, MultiGWAS
 provides the option to specify the number of best-ranked associtions, including
 significants and non-significants, to select from the resulting associations
 of each GWAS package.
 These associations are shown in the different tables and graphics reported
 by MultiGWAS (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:-View-Shared-SNPs"

\end_inset

).
\end_layout

\begin_layout Plain Layout
\begin_inset Note Comment
status collapsed

\begin_layout Itemize

\size footnotesize
\color blue
Thomson2011: 
\end_layout

\begin_deeper
\begin_layout Itemize

\size footnotesize
\color blue
Like primary GWAS, meta-analyses usually define P-value thresholds at which
 they will declare a finding to be genome-wide significant, often values
 around the 5?10?7 or 10?8 are used [55–57], perhaps combined with a less
 strin- gent level of 10?5 or 10?6 at which variants will be considered
 interesting enough to warrant further in- vestigation.
 Given the huge number of variants that are available for study, such low
 P-value thresholds are required to guard against the production of large
 numbers of false positives; however, they have the drawback that such conservat
ism may cause many variants with small real effects to be overlooked.
\end_layout

\begin_layout Itemize

\size footnotesize
\color blue
As a consequence, the testing paradigm is unhelpful and it is better to
 view the discovery of new variants, not as a series of tests, paradigm
 is unhelpful and it is better to view the discovery of new variants, not
 as a series of tests, but as an exploration, in which the P-values are
 a convenient screening tool rather than a measure of the strength of evidence.
 convenient screening tool rather than a measure of the strength of evidence.
\end_layout

\end_deeper
\begin_layout Itemize

\size footnotesize
\color blue
Wikipedia2020: 
\end_layout

\begin_deeper
\begin_layout Itemize

\size footnotesize
\color blue
However, there has been some criticism of this threshold, with a 2012 study
 suggesting that a significant number of associations with p-values just
 above this threshold are genuine, replicable associations.
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Plain Layout
Once the configurationf file is processed then the genomic data is preprocessed
 by selecting individuals present in both genotype and phenotype and excluding
 individuals and SNPs that have poor quality.
 Moreover, the format "ACGT" suitable for the polyploid software GWASpoly
 and SHEsis, is "diploidized" for PLINK and TASSEL.
 The homozygous tetraploid genotypes are converted to diploid thus: (e.g.,AAAA→AA,
 CCCC→CC, GGGG→GG, TTTT→TT).
 Moreover, for tetraploid heterozygous genotypes, the conversion depends
 on the reference and alternate alleles calculated for each position (e.g.
 AAAT→AT, ...
 ,CCCG→CG).
 After this process, MultiGWAS transform the genomic data to the formats
 required for each software.
\end_layout

\begin_layout Subsection
Multi analysis stage
\end_layout

\begin_layout Plain Layout
MultiGWAS runs in parallel using two types of statistical models specified
 in the parameters file, the Full model (Q+K) and Naive (i.e., without any
 control) 
\begin_inset CommandInset citation
LatexCommand cite
key "Sharma2018"

\end_inset

.
 The Full model (Q+K) controls for both population structure and individual
 relatedness.
 For population structure, MultiGWAS uses the Principal Component Analysis
 (PCA) and takes the top ten PC as covariates.
 For relatedness, the tool uses kinship matrices that TASSEL and GWASpoly
 calculated separately, and for PLINK and SHEsis depends on the King software
 
\begin_inset CommandInset citation
LatexCommand cite
key "Manichaikul2010"

\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

%
\backslash
subsubsection{Tools}
\end_layout

\end_inset

We have selected four GWAS software tools to be integrated in our multiGWAS
 tool, two designed specifically for polyploid species as many important
 crops are polyploids: GWASpoly 
\begin_inset CommandInset citation
LatexCommand cite
key "Rosyara2016"

\end_inset

 and SHEsis 
\begin_inset CommandInset citation
LatexCommand cite
key "Yong2006"

\end_inset

, and another two designed for diploids species and extensively used in
 humans and plants: PLINK 
\begin_inset CommandInset citation
LatexCommand cite
key "Purcell2007,Chang2015"

\end_inset

 and TASSEL 
\begin_inset CommandInset citation
LatexCommand cite
key "Bradbury2007"

\end_inset

, respectively.
\end_layout

\begin_layout Plain Layout
As MultiGWAS implements two types of GWAS analysis, naive and full, each
 tool is called in two different ways.
 
\begin_inset ERT
status open

\begin_layout Plain Layout

%The naive without any additional parameter, but the full with two parameters
 that take into account for population structure (Q) and relatedness (K)
 to prevent false associations.
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
GWASpoly
\end_layout

\begin_layout Plain Layout
GWASpoly 
\begin_inset CommandInset citation
LatexCommand cite
key "Rosyara2016"

\end_inset

 is an R package designed for GWAS in polyploid species used in several
 studies in plants 
\begin_inset CommandInset citation
LatexCommand cite
key "Berdugo2017,Ferrao2018,Sharma2018,Yuan2019"

\end_inset

.
 GWASpoly uses a Q+K linear mixed model with biallelic SNPs that account
 for population structure and relatedness.
 Also, to calculate the SNP effect for each genotypic class, GWASpoly provides
 eight gene action models (GAM): general, additive, simplex dominant alternative
, simplex dominant reference, duplex dominant alternative, and duplex dominant.
 As a consequence, the number of statistical test performed can be different
 in each GAM and so thresholds below which the 
\emph on
p-values
\emph default
 are considered significant.
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

% Threshold for each model
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
MultiGWAS is using GWASpoly version 1.3, employing all gene action models
 to find associations and repoting the top 
\emph on
N 
\emph default
best-ranked (the SNPs with lowest 
\emph on
p-values)
\emph default
, where 
\emph on
N
\emph default
 is defined by the user in the input configuration file.
 The 
\emph on
full 
\emph default
model used by GWASpoly includes the population structure and relatedness,
 which are estimated using the first five principal components and the kinship
 matrix, respectively, both calculated with the GWASpoly built-in algorithms.
\end_layout

\begin_layout Plain Layout
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
GWASpoly is a recent R package designed for GWAS in polyploid species that
 has been used in several studies in plants 
\begin_inset CommandInset citation
LatexCommand cite
key "Berdugo2017,Ferrao2018,Sharma2018,Yuan2019"

\end_inset

.
 It is based on the Q+K linear mixed model with biallelic SNPs that accounts
 for population structure and relatedness.
 In addition, to calculate the SNP effect for each genotypic class, GWASpoly
 provides a general gene action model along with four additional models:
 additive, simplex dominant, and duplex dominant.
\end_layout

\begin_layout Plain Layout
MultiGWAS is using GWASpoly version 1.3.
 The population structure and relatedness, used in the full model, are estimated
 using the first five principal components and the kinship matrix, respectively,
 both calculated with the algorithms built in GWASpoly.
 For both, naive and full models, all gene action models are tested for
 detecting associations
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
SHEsis
\end_layout

\begin_layout Plain Layout
SHEsis is another program designed for polyploid species that includes single
 locus association analysis, among others.
 It is based on a linear regresion model, and it has been used in some studies
 of animals and humans 
\begin_inset CommandInset citation
LatexCommand cite
key "Qiao2015,Meng2019"

\end_inset

.
\end_layout

\begin_layout Plain Layout
MultiGWAS is using the version 1.0 which does not take account for population
 structure or relatedness, however MultiGWAS externally estimates relatedness
 for SHEsis by excluding individuals with cryptic first-degree relatedness
 using the algorithm implemented in PLINK 2.0 (see below).
\end_layout

\begin_layout Subsubsection
PLINK
\end_layout

\begin_layout Plain Layout
PLINK is one of the most extensively used programs for GWAS in diploids
 species.
 It was developed for humans but it is applicable to any species 
\begin_inset CommandInset citation
LatexCommand cite
key "Power2016"

\end_inset

.
 PLINK includes a range of analysis, including univariate GWAS using two-sample
 tests and linear regression models.
\end_layout

\begin_layout Plain Layout
MultiGWAS is using two versions of PLINK: 1.9 and 2.0.
 Linear regression from PLINK 1.9 is used to achieve both types of analysis,
 naive and full.
 For the full analysis, population structure is estimated using the first
 five principal components calculated with the PLINK 1.9 built in algorithm.
 But relatedness is estimated from the kinship coefficients calculated with
 the PLINK 2.0 built in algorithm, removing the close relatives or individuals
 with first-degree relatedness.
\end_layout

\begin_layout Subsubsection
TASSEL
\end_layout

\begin_layout Plain Layout
TASSEL is another common GWAS program based on the Java software.
 It was developed for maize and it has been used in several studies in plants
 
\begin_inset CommandInset citation
LatexCommand cite
key "Alvarez2017,Zhang2018"

\end_inset

, but like PLINK, it is applicable to any species.
 For association analysis, TASSEL includes the general lineal model (GLM)
 and mixed linear model (MLM) that accounts for population structure and
 relatedness.
 And, in the same manner that GWASPoly, TASSEL provides three gene action
 models to calculate the SNP effect of each genotypc class: general, additive,
 and dominant, and so the significance threshold depends of each gene action
 model.
\end_layout

\begin_layout Plain Layout
MultiGWAS is using TASSEL 5.0, with all gene action models used to find the
 
\emph on
N 
\emph default
best-ranked associations and reporting the top 
\emph on
N 
\emph default
best-ranked associations (SNPs with lowest 
\emph on
p-values)
\emph default
.
 Naive GWAS is achieved by the GLM, and full GWAS is achieved by the MLM
 with two parameters: population structure that uses the first five principal
 components, and relatedness that uses the kinship matrix with centered
 IBS method, both calculated with the TASSEL built-in algorithms.
 
\end_layout

\begin_layout Subsection
Integration stage.
\end_layout

\begin_layout Plain Layout
The outputs resulting from the four software are scanned and processed to
 identify both significant and best-ranked associations.
 Based on the specification of the configuration file about the correction
 method and the significant level, MultiGWAS corrects the p-values and calculate
s the threshold value for each associated marker.
 The calculation uses the number of valid genotype calls (i.e., non-missing
 genotypes, phenotypes, and covariates).
 Then, MultiGWAS summarize the results in tables, Venn diagrams, SNP profiles,
 and Manhattan plots.
\end_layout

\end_inset


\end_layout

\end_body
\end_document
